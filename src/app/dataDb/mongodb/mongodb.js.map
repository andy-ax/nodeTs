{"version":3,"file":"mongodb.js","sourceRoot":"","sources":["mongodb.ts"],"names":[],"mappings":";;;AAAA,MAAM,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AACnC,MAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AACrC,gDAAmD;AAKnD,MAAa,OAAO;IAApB;QAIY,WAAM,GAAG,WAAW,CAAC;IAiCjC,CAAC;IA/BG,OAAO;QACH,IAAI,CAAC,EAAE,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAC1C,QAAQ,CAAA;QACR,qDAAqD;QACrD,uCAAuC;QACvC,6BAA6B;QAC7B,MAAM;QACN,EAAE;QACF,wCAAwC;QACxC,8BAA8B;QAC9B,+BAA+B;QAC/B,MAAM;QACN,EAAE;QACF,gDAAgD;QAChD,8BAA8B;QAC9B,iCAAiC;QACjC,MAAM;IACV,CAAC;IAED,MAAM,CAAC,gBAAgB,CAAC,MAAW,EAAE,IAAY;QAC7C,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE;YAChB,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;SAC3C;QACD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAC,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;IAC9D,CAAC;IAED,MAAM,CAAC,MAAM,CAAC,MAAqB;QAC/B,OAAO,CAAC,KAAK,GAAG,YAAY;YACxB,MAAM,CAAC,GAAG,GAAG,GAAG;YAChB,MAAM,CAAC,IAAI,GAAG,UAAU,CAAC;IACjC,CAAC;IAAA,CAAC;;AApCN,0BAqCC;AApCkB,aAAK,GAAG,aAAK,CAAC","sourcesContent":["const mongodb = require('mongodb');\r\nconst mongoose = require('mongoose');\r\nimport {DBPORT, DBURL} from '../../../model/model';\r\nexport type mongodbConfig = {\r\n    url: string;\r\n    port: string;\r\n}\r\nexport class Mongodb {\r\n    private static dbUrl = DBURL;\r\n    private db: any;\r\n\r\n    private status = 'unConnect';\r\n\r\n    connect() {\r\n        this.db = mongoose.connect(Mongodb.dbUrl);\r\n        debugger\r\n        // this.db.connection.on(\"error\", (error: Error) => {\r\n        //     console.log(\"数据库连接失败：\" + error);\r\n        //     this.status = 'error';\r\n        // });\r\n        //\r\n        // this.db.connection.on(\"open\", () => {\r\n        //     console.log(\"数据库连接成功\");\r\n        //     this.status = 'connect';\r\n        // });\r\n        //\r\n        // this.db.connection.on('disconnected', () => {\r\n        //     console.log('数据库连接断开');\r\n        //     this.status = 'unConnect';\r\n        // });\r\n    }\r\n\r\n    static createMongoModel(schema: any, name: string) {\r\n        if (!Mongodb.dbUrl) {\r\n            throw new Error('db url is not config');\r\n        }\r\n        return mongoose.model(name,(new mongoose.Schema(schema)));\r\n    }\r\n\r\n    static setUrl(config: mongodbConfig) {\r\n        Mongodb.dbUrl = 'mongodb://' +\r\n            config.url + ':' +\r\n            config.port + '/mongodb';\r\n    };\r\n}"]}